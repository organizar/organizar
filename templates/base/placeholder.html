{% load i18n %}
{% include "base/header_small.html" %}

<body id="placeholder" class="{% if request.user and request.user.is_superuser %}admin{% else %}member{% endif %}">

{% if info %}
	<h1>{{ info }}</h1>
{% endif%}
{% if request.session.status_info %}
	<div class="status-info-wrapper">
		<div class="status-info {% if form_type %}form{% endif %}" data-initial="{{ request.session.status_info }}">
			{{ request.session.status_info }}
		</div>
		<div class="close">x</div>
	</div>
{% endif%}

{% if form_type %}
	<div style="margin: 0 0 70px 0">
		<a href="/" class="button back">{% trans "back" %}</a>
	</div>
	{% if form_type == "event" %}
		{% include "base/forms/event.html" %}
	{% elif form_type == "person" %}
		{% include "base/forms/person.html" %}
	{% elif form_type == "contract" %}
		{% include "base/forms/contract.html" %}
	{% elif form_type == "event_group" %}
		{% include "base/forms/event_group.html" %}
	{% elif form_type == "edit_group" %}
		{% include "base/forms/edit_group.html" %}
	{% elif form_type == "standard_form" %}
		{% include "base/forms/standard_form.html" %}
	{% elif form_type == "todo" %}
		{% include "base/forms/todo.html" %}
	{% endif %}
{% elif form_second and form_action %}
	<div>
		<form action="{{ form_action }}" method="post">
			{% csrf_token %}
			{{ form_second.as_p }}
			<input class="button" type="submit" value="{% trans 'save' %}"/>
		</form>
	</div>
{% else %}


		{% include "base/menu.html" %}

		<section id="page">
			<div id="all_persons" class="hidden">
				{% for user in all_users  %}
					<a href="/person/edit/{{user.id }}/" class="search-value ajax show_in_overlay" data-divclassorid="#content">
						<button class="person"><span class="text">{% if not user.last_name %}{{ user.username }}{% elif user.first_name %}{{ user.first_name }} {{ user.last_name }}{% else %}{{ user.last_name }}{% endif %}</span> <img src="/media/img/edit.png" alt="edit"/></button> 
					</a>
				{% endfor %}
			</div>
			{% if request.user.is_superuser %}
				<div id="todos">
					<div class="menu">
						<div class="button show-hide-todos">&lt;</div>
						<a class="button add-todo ajax show_in_overlay" data-divclassorid="#content" href="/handle_todo/">
							+
						</a>
					</div>
					{% for todo in todos %}
						<div class="todo {{ todo.category | lower }} {{ todo.priority | lower }} {{ todo.done }}">
							{% for user in todo.users.all %}
								{{ user.first_name }} {{ user.last_name }}
							{% endfor %}
							<div class="hidden-data">
								<div class="close button">x</div>
								<a class="button ajax show_in_overlay" data-divclassorid="#content" href="/handle_todo/{{ todo.id }}/">
									Todo <img src="/media/img/edit.png" alt="edit"/>
								</a>
								<p><b>{{ todo.text }}</b></p>
								<p>Personen:</p>
								<ul>
								{% for user in todo.users.all %}
									<li>	
										{{ user.first_name }} {{ user.last_name }}
										<a class="button ajax" data-divclassorid="#content" href="/person/edit/{{ user.id }}/">
											<img src="/media/img/edit.png" alt="edit"/>
										</a>
									</li>
									{% if user.person.mobile %}{{ user.person.mobile }}{% endif %}
								{% endfor %}
								</ul>
								
								<p class="category"><b>{% trans "category" %}: {{ todo.category }}</b></p>
								<p class="priority"><b>{% trans "priority" %}: {{ todo.priority }}</b></p>
							</div>
						</div>
					{% endfor %}
				</div>
			{% endif %}
			<div id="cal-message"></div>
			<div id="time-raster"></div>
			<div id="events"></div>

		</section>
		<div id="overlay">
			<div id="overlay-background"></div>
			<div id="overlay-content">
				<div id="overlay-info"></div>
			</div>
		</div>
{% endif %}
		<div class="overlay overlay-cornershape" data-path-to="m 0,0 1439.999975,0 0,805.99999 -1439.999975,0 z">
			<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 1440 806" preserveAspectRatio="none">
				<path class="overlay-path" d="m 0,0 -1439.999975,0 0,-805.99999 0,805.99999 z"/>
			</svg>
			<button type="button" class="overlay-close">{% trans "close" %}</button>
		<div id="menu" class="menu">	<nav>

				<ul class="entries">
					{% if request.user.is_superuser %}
						<li class="entry"><a class="button ajax show_in_overlay" href="/handle_control_panel/" data-divclassorid="#content"><img src="/media/img/menu_white.png" alt="" />{% trans "controlCenter" %}</a></li>
						<!-- <li class="entry"><a class="button ajax show_in_overlay" data-divclassorid="#event-form-wrapper" href="/event/new/add/"><img src="/media/img/book_black.png" alt=""/><p>Stunde hinzufügen</p></a></li> -->
						<!--<a class="button" href="/contract/new/">Neuer Vertrag</a>-->
						<!--<a class="button" href="/sync_events/">Synchronisieren</a>-->
						<li class="entry"><a class="button ajax show_in_overlay" data-divclassorid="#content" href="/task_control/"><img src="/media/img/todo.png" alt=""/><p>{% trans "tasks" %}</p></a></li>
						<li class="entry"><a class="button ajax show_in_overlay" data-divclassorid="#page" data-callback="handle_contract" href="/contract_list/"><img src="/media/img/book_black.png" alt="" />{% trans "contracts" %}</a></li>

						<li class="entry"><a class="button ajax show_in_overlay" data-divclassorid="#content" href="/person/new/0/"><img src="/media/img/person.png" alt=""/><p>{% trans "createNewUser" %}</p></a></li>
						<!-- <li class="entry"><a class="button ajax show_in_menu" href="/handle_user/"><img src="/media/img/person.png" alt=""/> Benutzer Verwalten</a></li> -->
						<!--  
							barzaler
							persönliche daten
						 -->
					 {% endif %}
					<li class="entry"><a class="button ajax show_in_overlay" data-divclassorid="#print-page" href="/print/" ><img src="/media/img/print.png" alt=""/><p>{% trans "print" %}</p></a></li><!--<a href="/move_events_in_future">future</a>-->
					<li class="entry"><a class="button ajax" href="/person/edit/{{ user.id }}/" data-divclassorid="#content"><img src="/media/img/person.png" alt=""/><p>{% trans "ownProfile" %}</p></a></li>
				</ul>
			
			</nav></div>
		</div>
</body>
</html>
